[![返回目录](https://parg.co/Udx)](https://parg.co/UdT)

# 压力测试

在运维工作中，压力测试是一项很重要的工作。比如在一个网站上线之前，能承受多大访问量、在大访问量情况下性能怎样，这些数据指标好坏将会直接影响用户体验。但是，在压力测试中存在一个共性，那就是压力测试的结果与实际负载结果不会完全相同，就算压力测试工作做的再好，也不能保证 100% 和线上性能指标相同。面对这些问题，我们只能尽量去想方设法去模拟。所以，压力测试非常有必要，有了这些数据，我们就能对自己做维护的平台做到心中有数。


# 数据库压力测试

```
sudo aptitude install sysbench
echo "create database sbtest; grant all on sbtest.* to 'sbtest'@'localhost';" | mysql
sysbench --test=oltp --num-threads=10 prepare
sysbench --test=oltp --num-threads=10 run

sysbench --test=oltp --num-threads=16 --max-requests=100000 --mysql-socket=/var/lib/mysql/mysql.sock --mysql-user=root --db-driver=mysql --oltp-test-mode=complex run
```
# [Jepsen](https://github.com/aphyr/jepsen):模拟网络分割情况下数据库表现
随着NoSql数据存储方式的使用率增加，以及多存储方式混合解决方案日趋流行，开发团队在需要存储数据时有了多种选择。虽然这能带来很多益处，但是在不稳定的网络环境下产品行为有可能出现微妙的（以及不那么微妙的）问题，而这些问题有时即便是产品开发人员自己也难以理解。当任何人试图了解不同数据库和队列技术在不同场景下如何反应时，事实上都会把Jepsen及其博客作为参考。关键一点，使用这种在事务中包含客户端的方法来测试，给许多构建微服务的团队揭示了可能的错误模式。
